<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>OptionallyBlueStudios CheatSpy Developer Registration Service</title>
</head>
<body>
  <h2>Register For CheatSpy Developer Program</h2>
  <button id="generateBtn">Register To CheatSpy</button>

  <p><strong>Username:</strong> <span id="randomStr"></span></p>
  <p><strong>Password:</strong> <span id="hmacHex"></span></p>

  <script>
    function getKey() {
      const keyCharCodes = [85,70,68,89,79,73,53,52,54,48,57,56,85,69,70,126,64,63,83,65,71,62,70,68,116,111,104,106,101,64,126,102,58,100,115,75,71,39,59,111,105,117,54,56,121,51,57,56,103];
      return String.fromCharCode(...keyCharCodes);
    }

    function generateRandomString(length = 64) {
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
      let result = '';
      for (let i = 0; i < length; i++) {
        result += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      return result;
    }

    function bufferToHex(buffer) {
      return [...new Uint8Array(buffer)]
        .map(b => b.toString(16).padStart(2, '0'))
        .join('');
    }

    async function hmacSha384(key, message) {
      const encoder = new TextEncoder();
      const keyData = encoder.encode(key);
      const messageData = encoder.encode(message);

      const cryptoKey = await crypto.subtle.importKey(
        'raw',
        keyData,
        { name: 'HMAC', hash: 'SHA-384' },
        false,
        ['sign']
      );

      const signature = await crypto.subtle.sign('HMAC', cryptoKey, messageData);
      return bufferToHex(signature);
    }

    document.getElementById('generateBtn').addEventListener('click', async () => {
      const key = getKey();
      const randomStr = generateRandomString(64);
      const hmacHex = await hmacSha384(key, randomStr);

      document.getElementById('randomStr').textContent = randomStr;
      document.getElementById('hmacHex').textContent = hmacHex;
    });
  </script>
</body>
</html>
